<!doctype html><html prefix="og: https://ogp.me/ns#" lang=en><head><meta charset=utf-8><link rel=canonical href=https://uthark.github.io/2014/04/16/using-unitils-reflectionassert/><meta name=HandheldFriendly content="True"><meta name=MobileOptimized content="320"><meta name=viewport content="width=device-width,minimum-scale=1,maximum-scale=5"><title>Using Unitils ReflectionAssert</title><meta name=description content><meta name=keywords content><meta name=author content="Oleg Atamanenko"><link rel=stylesheet media=screen href="https://fonts.googleapis.com/css2?family=Lora:wght@500&family=Source+Code+Pro:wght@300&family=Bitter&display=swap" type=text/css><link rel=stylesheet href=https://uthark.github.io/css/theme.f98ae173ea806bb32a531ccc162d9ad4120465789080cf2bdb4f6fa2214f0e68.css><link rel=stylesheet href=https://uthark.github.io/css/uthark.css><link rel=stylesheet href=//maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css><link href=https://uthark.github.io/favicon.png rel=icon><link href=https://feeds.feedburner.com/atamanenko rel=alternate type=application/rss+xml title="Sharing knowledge"><meta name=twitter:card content="summary"><meta name=twitter:site content="@real_atamanenko"><meta name=twitter:creator content="@real_atamanenko"><meta name=twitter:title content="Using Unitils ReflectionAssert"><meta property="og:title" content="Using Unitils ReflectionAssert"><meta property="og:url" content="https://uthark.github.io/2014/04/16/using-unitils-reflectionassert/"><meta property="og:description" content="Often it is needed to compare two different instances of the class inside test. I.e. we save object into database, then fetch it back from db and we want to be sure if nothing was lost during saving/reading.
In order to make such assertions more easier and maintainable one can use great Unitils library which has useful class ReflectionAssert"></head><body><header class=site><h1><a href=https://uthark.github.io/>Sharing knowledge</a></h1><h2>by Oleg Atamanenko</h2></header><nav><div class=menu><input type=checkbox id=menu class="fa fa-bars">
<label for=menu aria-label=Menu></label><div class=menu-container><ul class=main-navigation><li><a href=https://uthark.github.io/ title=Posts>Posts</a></li><li><a href=https://uthark.github.io/usefularticles/ title=Links>Links</a></li><li><a href=https://uthark.github.io/categories/ title=Categories>Categories</a></li><li><a href=https://uthark.github.io/readinglist/ title="Reading Lists">Reading Lists</a></li><li><a href=https://uthark.github.io/about/ title=About>About</a></li></ul><ul class=subscription><li><a href=https://feeds.feedburner.com/atamanenko target=_blank type=application/rss+xml title=RSS><i class="fa fa-rss-square fa-lg"></i></a></li></ul><form action=https://www.google.com/search method=get target=_blank><fieldset role=search><input class=search type=text name=q placeholder=Search>
<input type=hidden name=q value=site:https://uthark.github.io/></fieldset></form></div></div></nav><div id=main><div id=content><div><article class=hentry><header><h1 class=entry-title>Using Unitils ReflectionAssert</h1></header><div class=entry-content><p>Often it is needed to compare two different instances of the class inside test. I.e. we save object into database, then fetch it back from db and we want to be sure if nothing was lost during saving/reading.</p><p>In order to make such assertions more easier and maintainable one can use great Unitils library which has useful class <a href=http://www.unitils.org/tutorial-reflectionassert.html>ReflectionAssert</a></p><p>First, update parent&rsquo;s <code>pom.xml</code>:</p><div class=highlight><pre class=chroma><code class=language-xml data-lang=xml><span class=nt>&lt;properties&gt;</span>
    <span class=nt>&lt;unitils.version&gt;</span>3.4<span class=nt>&lt;/unitils.version&gt;</span>
<span class=nt>&lt;/properties&gt;</span>
<span class=nt>&lt;dependency&gt;</span>
    <span class=nt>&lt;groupId&gt;</span>org.unitils<span class=nt>&lt;/groupId&gt;</span>
    <span class=nt>&lt;artifactId&gt;</span>unitils-core<span class=nt>&lt;/artifactId&gt;</span>
    <span class=nt>&lt;version&gt;</span>${unitils.version}<span class=nt>&lt;/version&gt;</span>
    <span class=nt>&lt;scope&gt;</span>test<span class=nt>&lt;/scope&gt;</span>
<span class=nt>&lt;/dependency&gt;</span>
</code></pre></div><p>Then add dependency to the child module:</p><div class=highlight><pre class=chroma><code class=language-xml data-lang=xml><span class=nt>&lt;dependency&gt;</span>
    <span class=nt>&lt;groupId&gt;</span>org.unitils<span class=nt>&lt;/groupId&gt;</span>
    <span class=nt>&lt;artifactId&gt;</span>unitils-core<span class=nt>&lt;/artifactId&gt;</span>
<span class=nt>&lt;/dependency&gt;</span>
</code></pre></div><p>Usage is very simple:
Add static import to the class.</p><div class=highlight><pre class=chroma><code class=language-java data-lang=java><span class=kn>import static</span> <span class=nn>org.unitils.reflectionassert.ReflectionAssert.assertReflectionEquals</span><span class=o>;</span>
</code></pre></div><p>and use it instead of regular JUnit assert:</p><div class=highlight><pre class=chroma><code class=language-java data-lang=java><span class=n>assertReflectionEquals</span><span class=o>(</span><span class=n>expected</span><span class=o>,</span> <span class=n>actual</span><span class=o>);</span>
</code></pre></div><p>It is possible to pass reflection comparator modes as optional parameters to the above method.</p><p>Be ware that this method is not very useful if you want to compare objects which has floating point or double parameters - ReflectionAssert compares <code>double</code> and <code>float</code> values using <code>==</code>, so it is not very useful. It is not possible to pass epsilon for comparison.</p><p>excerpt from <code>org.unitils.reflectionassert.comparator.impl.LenientNumberComparator#compare</code>:</p><div class=highlight><pre class=chroma><code class=language-java data-lang=java><span class=n>Double</span> <span class=n>leftDouble</span> <span class=o>=</span> <span class=n>getDoubleValue</span><span class=o>(</span><span class=n>left</span><span class=o>);</span>
<span class=n>Double</span> <span class=n>rightDouble</span> <span class=o>=</span> <span class=n>getDoubleValue</span><span class=o>(</span><span class=n>right</span><span class=o>);</span>
<span class=k>if</span> <span class=o>(!</span><span class=n>leftDouble</span><span class=o>.</span><span class=na>equals</span><span class=o>(</span><span class=n>rightDouble</span><span class=o>))</span> <span class=o>{</span>
    <span class=k>return</span> <span class=k>new</span> <span class=n>Difference</span><span class=o>(</span><span class=n>differenceMessage</span><span class=o>,</span> <span class=n>left</span><span class=o>,</span> <span class=n>right</span><span class=o>);</span>
<span class=o>}</span>
</code></pre></div><p>If you need to compare double values in JUnit assertions then it is better to use <a href=https://code.google.com/p/hamcrest/>hamcrest library</a>.</p><div class=highlight><pre class=chroma><code class=language-java data-lang=java><span class=kn>import static</span> <span class=nn>org.hamcrest.number.IsCloseTo.closeTo</span><span class=o>;</span>
<span class=kn>import static</span> <span class=nn>org.junit.Assert.assertThat</span><span class=o>;</span>

<span class=c1>// in @Test method:
</span><span class=c1></span><span class=n>assertThat</span><span class=o>(</span><span class=n>actual</span><span class=o>.</span><span class=na>getFederalIncomeTax</span><span class=o>(),</span> <span class=n>closeTo</span><span class=o>(</span><span class=n>expected</span><span class=o>.</span><span class=na>getFederalIncomeTax</span><span class=o>(),</span> <span class=n>EPSILON</span><span class=o>))</span>
</code></pre></div><p>Happy hacking!</p></div><footer><div class=sharing>Share:
<a href="https://getpocket.com/save?url=https%3a%2f%2futhark.github.io%2f2014%2f04%2f16%2fusing-unitils-reflectionassert%2f" target=_blank><i class="fa fa-get-pocket" title="Save to Pocket" aria-hidden=true></i></a><a href="https://twitter.com/intent/tweet?text=Using%20Unitils%20ReflectionAssert&url=https%3a%2f%2futhark.github.io%2f2014%2f04%2f16%2fusing-unitils-reflectionassert%2f" target=_blank title="Post to Twitter" aria-hidden=true><i class="fa fa-twitter"></i></a></div><div><hr><p>If you have any questions, feel free to ping me on Twitter.</p></div><p class=meta>Estimated reading time: 2 minute(s)</p><p class=meta>Last update: <time datetime=2014-04-16>Apr 16, 2014</time></p><p class=meta>Categories: <a class=label href=https://uthark.github.io/categories/development/>#development</a><a class=label href=https://uthark.github.io/categories/article/>#article</a><a class=label href=https://uthark.github.io/categories/java/>#java</a><a class=label href=https://uthark.github.io/categories/unit-testing/>#unit testing</a><a class=label href=https://uthark.github.io/categories/unitils/>#unitils</a><a class=label href=https://uthark.github.io/categories/reflectionassert/>#reflectionassert</a></p></p><p class=meta><a class="basic-alignment left" href=https://uthark.github.io/2014/04/15/using-assertj/ title="Using AssertJ">&lt;&lt;&nbsp;Using AssertJ</a>
<a class="basic-alignment right" href=https://uthark.github.io/2014/04/23/pocket-is-down/ title="Pocket is down">Pocket is down&nbsp;>></a></p><div id=disqus_thread></div><script type=application/javascript>var disqus_config=function(){};(function(){if(["localhost","127.0.0.1"].indexOf(window.location.hostname)!=-1){document.getElementById('disqus_thread').innerHTML='Disqus comments not available by default when the website is previewed locally.';return;}
var d=document,s=d.createElement('script');s.async=true;s.src='//'+"uthark"+'.disqus.com/embed.js';s.setAttribute('data-timestamp',+new Date());(d.head||d.body).appendChild(s);})();</script><noscript>Please enable JavaScript to view the <a href=https://disqus.com/?ref_noscript>comments powered by Disqus.</a></noscript><a href=https://disqus.com class=dsq-brlink>comments powered by <span class=logo-disqus>Disqus</span></a></footer></article></div><aside class="sidebar thirds"><section class="first odd"><p></p></section><section class=even><div class=toc-header>Table of Contents</div><nav id=TableOfContents></nav></section></aside></div></div><footer><div class=center><ul class=sidebar-nav><li class=sidebar-nav-item><a target=_blank href=https://github.com/uthark/ title=https://github.com/uthark/><i class="fa fa-github fa-2x"></i></a></li><li class=sidebar-nav-item><a target=_blank href=https://bitbucket.org/uthark/ title=https://bitbucket.org/uthark/><i class="fa fa-bitbucket fa-2x"></i></a><li class=sidebar-nav-item><a target=_blank href=https://twitter.com/real_atamanenko title=https://twitter.com/real_atamanenko><i class="fa fa-twitter fa-2x"></i></a><li class=sidebar-nav-item><a target=_blank href=https://keybase.io/uthark/ title=https://keybase.io/uthark/><i class="fa fa-key fa-2x"></i></a><li class=sidebar-nav-item><a target=_blank href=http://stackoverflow.com/users/216764/uthark title=http://stackoverflow.com/users/216764/uthark><i class="fa fa-stack-overflow fa-2x"></i></a></li><li><a href=https://feeds.feedburner.com/atamanenko target=_blank type=application/rss+xml title=RSS><i class="fa fa-rss-square fa-2x"></i></a></li></ul></div><p>&copy;&nbsp;2009&nbsp;—&nbsp;2021 Oleg Atamanenko - <a href=https://uthark.github.io/license/>CC&nbsp;BY-SA&nbsp;4.0</a></p></footer><script>var _gaq=[['_setAccount','UA-8688665-1'],['_trackPageview']];(function(d,t){var g=d.createElement(t),s=d.getElementsByTagName(t)[0];s.async='async'
g.src=('https:'==location.protocol?'//ssl':'//www')+'.google-analytics.com/ga.js';s.parentNode.insertBefore(g,s)}(document,'script'));</script></body></html>